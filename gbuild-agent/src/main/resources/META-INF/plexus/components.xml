<component-set>
  <components>
    <!--
    <component>
      <role>org.apache.geronimo.gbuild.Main</role>
      <implementation>org.apache.geronimo.gbuild.Main</implementation>
      <requirements>
        <requirement>
          <role>org.apache.geronimo.gbuild.BuildAgent</role>
        </requirement>
      </requirements>
    </component>
    -->
    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgent</role>
      <role-hint>build-executor</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.ContinuumBuildAgent</implementation>
      <requirements>
        <requirement>
          <role>org.apache.geronimo.gbuild.agent.BuildAgentExtentionManager</role>
        </requirement>
        <requirement>
          <role>org.apache.maven.continuum.buildcontroller.BuildController</role>
        </requirement>
        <requirement>
          <role>org.apache.maven.continuum.configuration.ConfigurationService</role>
        </requirement>
      </requirements>
      <configuration>
        <contributor>Unknown</contributor>
        <admin-address>scm@geronimo.apache.org</admin-address>
        <coordinator-url>tcp://localhost:61616</coordinator-url>
        <build-task-queue>BUILD.TASKS</build-task-queue>
        <build-results-topic>BUILD.RESULTS</build-results-topic>
        <working-directory>agent/work</working-directory>
        <build-output-directory>agent/output</build-output-directory>
      </configuration>
    </component>

    <component>
      <role>org.codehaus.plexus.action.Action</role>
      <role-hint>execute-builder</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.ExecuteDistributedBuilderContinuumAction</implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.continuum.configuration.ConfigurationService</role>
        </requirement>
        <requirement>
          <role>org.apache.maven.continuum.execution.manager.BuildExecutorManager</role>
        </requirement>
        <requirement>
          <role>org.apache.maven.continuum.notification.ContinuumNotificationDispatcher</role>
        </requirement>
        <requirement>
          <role>org.apache.maven.continuum.store.ContinuumStore</role>
        </requirement>
      </requirements>
    </component>

    <component>
      <role>org.apache.maven.continuum.store.ContinuumStore</role>
      <role-hint>agent-store</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.ThreadContextContinuumStore</implementation>
    </component>

    <component>
      <role>org.apache.maven.continuum.notification.ContinuumNotificationDispatcher</role>
      <!--<role-hint>agent-notifier</role-hint>-->
      <implementation>org.apache.geronimo.gbuild.agent.MockContinuumNotificationDispatcher</implementation>
    </component>

    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgentExtentionManager</role>
      <implementation>org.apache.geronimo.gbuild.agent.DefaultBuildAgentExtentionManager</implementation>
      <requirements>
        <requirement>
          <role>org.apache.geronimo.gbuild.agent.BuildAgentExtention</role>
          <field-name>extentions</field-name>
        </requirement>
      </requirements>
    </component>

    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgentExtention</role>
      <role-hint>file-include</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.FileIncludeExtention</implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.continuum.configuration.ConfigurationService</role>
        </requirement>
      </requirements>
      <configuration>
        <pattern>^include</pattern>
      </configuration>
    </component>

    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgentExtention</role>
      <role-hint>general-headers</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.HeaderIncludeExtention</implementation>
      <configuration>
        <pattern>^(project|build|header).*</pattern>
      </configuration>
    </component>


    <!--
    | Build Producer
    -->
    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgent</role>
      <role-hint>build-producer</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.PropertiesBuildTaskProducer</implementation>
      <configuration>
        <coordinator-url>tcp://localhost:61616</coordinator-url>
        <build-task-queue>BUILD.TASKS</build-task-queue>
        <include-prefix>include.</include-prefix>
        <header-prefix>header.</header-prefix>
        <watch-directory>tasks</watch-directory>
        <poll-interval>10000</poll-interval>
      </configuration>
    </component>

    <!--
    | Build Results
    -->
    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgent</role>
      <role-hint>build-results</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.BuildResultsContinuumAgent</implementation>
      <requirements>
        <requirement>
          <role>org.apache.geronimo.gbuild.agent.BuildResultsExtentionManager</role>
        </requirement>
      </requirements>
      <configuration>
        <coordinator-url>tcp://localhost:61616</coordinator-url>
        <build-results-topic>BUILD.RESULTS</build-results-topic>
      </configuration>
    </component>

    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildResultsExtentionManager</role>
      <implementation>org.apache.geronimo.gbuild.agent.DefaultBuildResultsExtentionManager</implementation>
      <requirements>
        <requirement>
          <role>org.apache.geronimo.gbuild.agent.BuildResultsExtention</role>
          <field-name>extentions</field-name>
        </requirement>
      </requirements>
    </component>

    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildResultsExtention</role>
      <role-hint>write-include-file</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.WriteIncludeFileExtention</implementation>
      <configuration>
        <include-pattern>^include.*</include-pattern>
        <file-extention>.properties</file-extention>
        <results-directory>results</results-directory>
        <use-header>project.name</use-header>
        <date-format>yyyy-MM-dd</date-format>
      </configuration>
    </component>


    <!--
    | Ping monitor
    -->
    <component>
      <role>org.apache.geronimo.gbuild.agent.BuildAgent</role>
      <role-hint>ping-monitor</role-hint>
      <implementation>org.apache.geronimo.gbuild.agent.PingMonitorAgent</implementation>
      <configuration>
        <coordinator-url>tcp://localhost:61616</coordinator-url>
      </configuration>
    </component>

  </components>
</component-set>
